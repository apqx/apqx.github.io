---
layout: post
type: original
categories: original
title: "åŸºäºJekyllçš„åšå®¢æ–‡ç« ã€Œæ ‡ç­¾åŒ–ã€å®ç°"
author: ç«‹æ³‰
date: 2021-09-01 +0800
description: 
cover: 
tags: CS Blog Jekyll GitHub
---

è‡ªé‡æ„ä¹‹åï¼Œæˆ‘çš„åšå®¢æ˜¯æ”¯æŒ`æ ‡ç­¾`çš„ï¼Œæ¯ä¸€ç¯‡æ–‡ç« éƒ½ä¼šè¢«æ ‡è®°ä¸€äº›å…³é”®è¯ä½œä¸º`æ ‡ç­¾`ï¼Œé€šè¿‡`æ ‡ç­¾`å¯ä»¥å¤§æ¦‚äº†è§£æ–‡ç« çš„ä¾§é‡ç‚¹ï¼Œä¸”ä¸åŒæ–‡ç« ä¹Ÿå¯ä»¥æ‹¥æœ‰ç›¸åŒçš„`æ ‡ç­¾`ï¼Œè¡¨æ˜å®ƒä»¬å­˜åœ¨å…³è”æ€§ã€‚è¿™äº›`æ ‡ç­¾`å›ºå®šæ˜¾ç¤ºåœ¨æ–‡ç« é¡¶éƒ¨ï¼Œç‚¹å‡»å°±ä¼šå¼¹å‡ºä¸€ä¸ªåŒ…å«æ‰€æœ‰æ ‡è®°äº†è¿™ä¸ª`æ ‡ç­¾`çš„æ–‡ç« åˆ—è¡¨å¼¹çª—ï¼Œå°†ç«™å†…çš„å…¶ä»–ç›¸å…³æ–‡ç« ä¸€è§ˆæ— ä½™ï¼Œæ‰€ä»¥`æ ‡ç­¾`çœŸçš„æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„æ–‡ç« åˆ†ç±»æ–¹æ³•ã€‚

<video playsinline controls muted preload="none" poster="https://apqx.oss-cn-hangzhou.aliyuncs.com/blog/20210901/tags_h264_thumb.jpg">
    <!-- chromeä¸æ”¯æŒh265 -->
    <source src="https://apqx.oss-cn-hangzhou.aliyuncs.com/blog/20210901/tags_h264.mp4" type="video/mp4">
</video>

è¿™ä¸ªåšå®¢æ˜¯ç”±[Jekyll](https://jekyllrb.com){: target="_blank" }é©±åŠ¨çš„ï¼Œå€ŸåŠ©[Liquid](https://shopify.github.io/liquid/){: target="_blank" }æ¨¡ç‰ˆè¯­è¨€ï¼Œè¦å®ç°`æ ‡ç­¾`å…¶å®å¹¶ä¸å¤æ‚ã€‚

# é™æ€é¡µé¢

é¦–å…ˆåœ¨ç”¨`MarkDown`å†™ä½œçš„æ–‡ç« å¤´éƒ¨æ·»åŠ `Jekyll`åŸç”Ÿæ”¯æŒçš„`tags`å³`æ ‡ç­¾`ï¼Œå¯ä»¥æ·»åŠ å¤šä¸ªï¼Œç”¨ç©ºæ ¼éš”å¼€ï¼š

```markdown
---
layout: post
type: original
categories: original
title: "æ—…è¡Œå¿—03ï¼šå…°è‹‘ç‹®å¼"
author: ç«‹æ³‰
date: 2021-06-10 +0800
tags: ç¢ç¢å¿µ æˆå‰§ çœæ˜† æ—…è¡Œ æ‘„å½±
---
```

ç„¶åæ‰¾åˆ°æŠŠ`MarkDown`æ–‡ç« è½¬æ¢æˆ`HTML`é¡µé¢çš„å¯¹åº”`_layout`å¸ƒå±€æ–‡ä»¶ï¼Œç”¨`Liquid`è¯­è¨€è·å–æ•´ä¸ªç«™ç‚¹çš„`tag`åˆ—è¡¨å’Œå½“å‰æ–‡ç« çš„`tag`åˆ—è¡¨ä»¥åŠæ ‡è®°äº†æŸä¸ª`tag`çš„æ‰€æœ‰æ–‡ç« ä¿¡æ¯ï¼Œä¸ºå½“å‰æ–‡ç« çš„æ¯ä¸€ä¸ª`tag`ç”Ÿæˆç›¸å…³è”çš„æ–‡ç« åˆ—è¡¨ï¼š

```html
{%- raw %}
<!-- éå†å½“å‰é¡µé¢æ ‡è®°çš„tagåˆ—è¡¨ -->
{% for tagInPage in page.tags %}
    <!-- éå†æ•´ä¸ªç«™ç‚¹çš„æ‰€æœ‰tagåˆ—è¡¨ -->
    {% for tagInSite in site.tags %}
        <!-- ä»ç«™ç‚¹tagåˆ—è¡¨ä¸­æ‰¾åˆ°å½“å‰é¡µé¢çš„tag -->
        <!-- ç«™ç‚¹tagæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œtag[0]ä¸ºè¯¥tagçš„åå­—ï¼Œtag[1]ä¸ºæ ‡è®°äº†è¯¥tagçš„æ‰€æœ‰æ–‡ç« ä¿¡æ¯åˆ—è¡¨ -->
        {% if tagInPage == tagInSite[0] %}
            <!-- éå†æ ‡è®°äº†æ­¤tagçš„æ‰€æœ‰æ–‡ç« ä¿¡æ¯åˆ—è¡¨ -->
            {% for post in tagInSite[1] %}
                <!-- è¿™é‡Œå°±å¯ä»¥æŠŠè¿™äº›æ–‡ç« åˆ—è¡¨å¡«å……åˆ°htmlä¸­é‡Œï¼Œå½“ç‚¹å‡»äº†æŸä¸ªtagçš„æ—¶å€™ä»¥åˆé€‚çš„æ–¹å¼æ˜¾ç¤ºå‡ºæ¥ï¼Œæˆ‘ç”¨çš„æ˜¯å¼¹çª— -->
                {{ post.title }}
                {{ post.date | date: "%Y.%m.%d" }}
                {{ post.url | prepend: site.baseurl }}
            {% endfor %}
        {% endif %}
    {% endfor %}
{% endfor %}{% endraw %}
```

è¿™æ ·åœ¨ç¼–è¯‘æ—¶å°±ç›´æ¥æŠŠç›¸å…³æ–‡ç« åˆ—è¡¨å†™å…¥åˆ°äº†ç”Ÿæˆçš„é™æ€`HTML`é¡µé¢é‡Œï¼Œä¸€èˆ¬æ˜¯å…ˆéšè—ï¼Œåœ¨åˆé€‚çš„æ—¶æœºï¼ˆæ¯”å¦‚ç‚¹å‡»`æ ‡ç­¾`æ—¶ï¼‰æ˜¾ç¤ºå‡ºæ¥ã€‚ä½†æ˜¯å½“æˆ‘å¼€å§‹æ¥å…¥`Google`æœç´¢åå´æ„å¤–å‘ç°ï¼Œ`Google`åœ¨è§£ææŠ“å–åˆ°çš„é¡µé¢å¹¶ç”Ÿæˆç´¢å¼•æ—¶ä¼šæŠŠé¡µé¢å†…çš„é‚£ä¸ªæ–‡ç« åˆ—è¡¨è¯¯è®¤ä¸ºæ˜¯æ–‡ç« çš„å†…å®¹ï¼Œè¿™æ ·åœ¨æœç´¢æ—¶å°±ä¼šæœå‡ºä¸€äº›å®Œå…¨ä¸ç›¸å¹²çš„æ–‡ç« ï¼Œä»…ä»…æ˜¯å› ä¸ºå®ƒä»¬éƒ½æ ‡è®°äº†æŸä¸ªç›¸åŒçš„`æ ‡ç­¾`è€Œæ–‡ç« åˆ—è¡¨é‡Œåˆæ°å¥½åŒ…å«äº†è¦æœç´¢çš„å…³é”®å­—ã€‚æ‰€ä»¥ï¼Œé™æ€é¡µé¢è™½ç„¶ç®€å•ä½†ä¼´éšç€å¾ˆå¤šé—®é¢˜ï¼Œç”Ÿæˆ`HTML`é¡µé¢åªèƒ½ä½¿ç”¨`Liquid`ååˆ†æœ‰é™çš„è¯­æ³•ç›¸æ¯”èµ·å¼ºå¤§çš„`JavaScript`ä¹Ÿä¸å¤Ÿçµæ´»ã€‚

# åŠ¨æ€åŠ è½½

é‚£ä¹ˆè§£å†³æ–¹æ³•ä¹Ÿå¾ˆæ˜ç¡®äº†ï¼Œä¸æŠŠæ–‡ç« åˆ—è¡¨å†™å…¥é™æ€é¡µé¢è€Œæ˜¯åœ¨éœ€è¦æ—¶åŠ¨æ€åŠ è½½ï¼Œå€ŸåŠ©[Jekyll-Archive](https://github.com/jekyll/jekyll-archives){: target="_blank" }æ’ä»¶å¯ä»¥ä¸ºæ¯ä¸ª`tag`ç”Ÿæˆä¸€ä¸ªåŒ…å«äº†ç›¸å…³æ–‡ç« åˆ—è¡¨çš„`HTML`æ–‡ä»¶ï¼Œåˆ°æ—¶å€™è¯»å–è¿™ä¸ªæ–‡ä»¶ï¼ŒæŠŠè§£æå‡ºçš„å†…å®¹æ’å…¥åˆ°æ–‡ç« é¡µé¢é‡Œæ˜¾ç¤ºå‡ºæ¥å°±å¯ä»¥äº†ã€‚

èŠ±ä¸€å¤©æ—¶é—´åšå®Œå`PUSH`åˆ°`GitHub Pages`ä¸Šå´æ²¡æœ‰ç”Ÿæ•ˆï¼Œæ˜æ˜åœ¨æœ¬åœ°æ˜¯æ­£å¸¸è¿è¡Œçš„ï¼Œæœç´¢äº†ä¸€åœˆæ‰çŸ¥é“ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„`Jekyll`æ’ä»¶éƒ½èƒ½åœ¨`GitHub Pages`ä¸Šä½¿ç”¨ï¼Œå—æ”¯æŒçš„åªæœ‰å¾ˆå°‘ä¸€éƒ¨åˆ†ï¼Œè€Œ`Jekyll-Archive`å¹¶ä¸åœ¨[è¿™ä¸ªåˆ—è¡¨](https://pages.github.com/versions/){: target="_blank" }é‡Œã€‚

æ’ä»¶æ— éæ˜¯å¯¹`Jekyll`åŸç”ŸåŠŸèƒ½çš„å°è£…ï¼Œæ—¢ç„¶ä¸èƒ½ç”¨æ’ä»¶ï¼Œæ‰‹åŠ¨å®ç°ç”Ÿæˆ`tag`å’Œæ–‡ç« åˆ—è¡¨çš„æ˜ å°„åº”è¯¥ä¹Ÿä¸ä¼šå¾ˆéš¾ï¼Œå‚è€ƒ[è¿™ç¯‡æ–‡ç« ](https://aneejian.com/automated-jekyll-archives-github-pages/){: target="_blank" }çš„å‰åŠéƒ¨åˆ†ï¼Œå…¶å®éå¸¸ç®€å•ã€‚

åœ¨`Jekyll`çš„`_config.yml`é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ä¸€ä¸ªåä¸º`archives`çš„`collection`è¾“å‡ºï¼š

```yml
# è¯»å–æŒ‡å®šç›®å½•é‡Œçš„é…ç½®æ–‡ä»¶å¹¶å‘æŒ‡å®šçš„ç›®å½•è¾“å‡ºåŒ…å«æŒ‡å®šå†…å®¹çš„æ–‡ä»¶
collections:
    # æŒ‡å®šé…ç½®æ–‡ä»¶ç›®å½•ä¸º`_archives/`
    archives:
        output: true
        # æŒ‡å®šè¾“å‡ºç›®å½•ä¸º `_site/archive/`
        permalink: /archive/:path/
```

åˆ›å»º`_archives`ç›®å½•å¹¶åœ¨è¯¥ç›®å½•ä¸­æ–°å»ºä¸€ä¸ªåä¸º`tag.txt`çš„æ–‡ä»¶ï¼Œå†™å…¥ä»¥ä¸‹å†…å®¹ï¼š

```json
{%- raw %}
{
    "tags":[
        
        {% comment %}éå†æ•´ä¸ªç«™ç‚¹çš„æ‰€æœ‰tagåˆ—è¡¨{% endcomment %}

        {%- for tag in site.tags %}
        {
            "tag":"{{ tag[0] }}",
            "posts":[

                {% comment %}éå†æ ‡è®°äº†æ­¤tagçš„æ‰€æœ‰æ–‡ç« åˆ—è¡¨{% endcomment %}

                {%- for post in tag[1] %}
                {
                    "title": "{{ post.title }}",
                    "date": "{{ post.date | date: "%Yå¹´%mæœˆ%dæ—¥" }}",
                    "url": "{{ post.url | prepend: site.baseurl }}"
                }{% unless forloop.last %},{% endunless %}
                {%- endfor %}
            ]
        }{% unless forloop.last %},{% endunless %}
        {%- endfor %}
    ]
}{% endraw %}
```

æŒ‰ç…§`Liquid`æ¨¡ç‰ˆè¯­è¨€çš„è¯­æ³•ï¼Œè¿™æ®µä»£ç çš„ä½œç”¨æ˜¯éå†æ‰€æœ‰`tag`ï¼Œå¹¶å°†æ¯ä¸ª`tag`å’Œç›¸å…³æ–‡ç« åˆ—è¡¨ä»¥`json`æ ¼å¼è¾“å‡ºã€‚å¦‚æœä»¥ä¸Šé…ç½®æ­£ç¡®ï¼Œæ‰§è¡Œ`Jekyll`çš„`build`æŒ‡ä»¤ï¼Œå°±ä¼šåœ¨`_site/archive/tag/`ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ª`index.html`æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶çš„å†…å®¹å°±æ˜¯ä¸Šé¢è¾“å‡ºçš„`json`ï¼š

```json
{
    "tags": [
        {
            "tag": "æ—…è¡Œ",
            "posts": [
                {
                    "title": "æ—…è¡Œå¿—03ï¼šå…°è‹‘ç‹®å¼",
                    "date": "2021å¹´06æœˆ10æ—¥",
                    "url": "/post/original/2021/06/10/%E6%97%85%E8%A1%8C%E5%BF%9703-%E5%85%B0%E8%8B%91%E7%8B%AE%E5%90%BC.html"
                },
                {
                    "title": "æ—…è¡Œå¿—02ï¼šé­”éƒ½ä¸æµ®ç”Ÿå…­è®°",
                    "date": "2021å¹´01æœˆ17æ—¥",
                    "url": "/post/original/2021/01/17/%E6%97%85%E8%A1%8C%E5%BF%9702-%E9%AD%94%E9%83%BD%E4%B8%8E%E6%B5%AE%E7%94%9F%E5%85%AD%E8%AE%B0.html"
                },
                {
                    "title": "æ—…è¡Œå¿—01ï¼šå»å—äº¬çœ‹æ˜†æ›²",
                    "date": "2019å¹´06æœˆ06æ—¥",
                    "url": "/post/original/2019/06/06/%E6%97%85%E8%A1%8C%E5%BF%9701-%E5%8E%BB%E5%8D%97%E4%BA%AC%E7%9C%8B%E6%98%86%E6%9B%B2.html"
                }
            ]
        },
        {
            "tag": "æˆå‰§",
            "posts": [
                {
                    "title": "æ—…è¡Œå¿—03ï¼šå…°è‹‘ç‹®å¼",
                    "date": "2021å¹´06æœˆ10æ—¥",
                    "url": "/post/original/2021/06/10/%E6%97%85%E8%A1%8C%E5%BF%9703-%E5%85%B0%E8%8B%91%E7%8B%AE%E5%90%BC.html"
                },
                {
                    "title": "çœ‹ä¸€å‡ºå¥½å‰§ï¼Œæµ™æ˜†ã€Šè¥¿å›­è®°ã€‹",
                    "date": "2021å¹´04æœˆ28æ—¥",
                    "url": "/post/original/2021/04/28/%E7%9C%8B%E4%B8%80%E5%87%BA%E5%A5%BD%E5%89%A7-%E6%B5%99%E6%98%86-%E8%A5%BF%E5%9B%AD%E8%AE%B0.html"
                },
                {
                    "title": "å¤®è§†ã€æˆå‰§ã€4Kã€HEVCï¼ŒæƒŠå–œè¿è¿",
                    "date": "2021å¹´02æœˆ25æ—¥",
                    "url": "/post/original/2021/02/25/%E5%A4%AE%E8%A7%86-%E6%88%8F%E5%89%A7-4K-HEVC-%E6%83%8A%E5%96%9C%E8%BF%9E%E8%BF%9E.html"
                },
                {
                    "title": "æ—…è¡Œå¿—02ï¼šé­”éƒ½ä¸æµ®ç”Ÿå…­è®°",
                    "date": "2021å¹´01æœˆ17æ—¥",
                    "url": "/post/original/2021/01/17/%E6%97%85%E8%A1%8C%E5%BF%9702-%E9%AD%94%E9%83%BD%E4%B8%8E%E6%B5%AE%E7%94%9F%E5%85%AD%E8%AE%B0.html"
                },
                {
                    "title": "åˆè§æµ™æ˜†ã€Œä»£ã€å­—è¾ˆ",
                    "date": "2021å¹´01æœˆ12æ—¥",
                    "url": "/post/original/2021/01/12/%E5%88%9D%E8%A7%81%E6%B5%99%E6%98%86-%E4%BB%A3-%E5%AD%97%E8%BE%88.html"
                },
                {
                    "title": "æ—…è¡Œå¿—01ï¼šå»å—äº¬çœ‹æ˜†æ›²",
                    "date": "2019å¹´06æœˆ06æ—¥",
                    "url": "/post/original/2019/06/06/%E6%97%85%E8%A1%8C%E5%BF%9701-%E5%8E%BB%E5%8D%97%E4%BA%AC%E7%9C%8B%E6%98%86%E6%9B%B2.html"
                },
                {
                    "title": "æ§å®‰å›½å†…æ˜¥ç”Ÿé…’",
                    "date": "2019å¹´05æœˆ18æ—¥",
                    "url": "/post/original/2019/05/18/%E6%A7%90%E5%AE%89%E5%9B%BD%E5%86%85%E6%98%A5%E7%94%9F%E9%85%92.html"
                }
            ]
        }
    ]
}
```

[https://apqx.me/archive/tag/index.html]({% link _archives/tag.txt %}){: target="_blank" }

æœ‰äº†è¿™ä¸ªæ˜ å°„`json`ï¼Œåœ¨ç‚¹å‡»æŸä¸ª`tag`çš„æ—¶å€™åŠ è½½å¯¹åº”çš„æ–‡ç« åˆ—è¡¨å¹¶æ˜¾ç¤ºå‡ºæ¥å°±å¯ä»¥å¾ˆè½»æ¾çš„ä¸€æ­¥æ­¥å®ç°äº†ã€‚å‘ƒï¼Œå¥½å§ï¼Œå¦‚æœä¸å¤ªç†Ÿæ‚‰`JS`çš„è¯å¥½åƒä¹Ÿä¸æ˜¯å¾ˆâ€œè½»æ¾â€ğŸ¤”ï¼Œæ¯”å¦‚æˆ‘ï¼Œè¿™ç§æ„Ÿè§‰å¹¶ä¸æ˜¯â€œéš¾â€ï¼Œæ€è·¯æ˜¯æ¸…æ™°çš„ï¼Œåªæ˜¯ä¸ç†Ÿæ‚‰è¯­æ³•å’Œç±»åº“ï¼Œä»¥è‡³äºæ¯å‰è¿›ä¸€ç‚¹éƒ½ä¼šç£•ç£•ç»Šç»Šï¼Œéœ€è¦å¤šèŠ±äº›æ—¶é—´ã€‚ä¸è¿‡â€œä¹…ç—…æˆè‰¯åŒ»â€ï¼Œå³ä½¿ä¸ç³»ç»Ÿæ€§çš„å­¦ä¹ æ•´ä¸ª`Web`æŠ€æœ¯æ ˆï¼Œé•¿æœŸä»è¾¹è¾¹è§’è§’çš„æ¥è§¦ä¹Ÿè¶³ä»¥è®©æˆ‘æŠŠè¿™ä¸ªåšå®¢ç«™ç‚¹çš„ç©ºæƒ³è®¾è®¡å˜ä¸ºç°å®ã€‚