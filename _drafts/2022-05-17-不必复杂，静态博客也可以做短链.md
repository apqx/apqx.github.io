---
layout: post
categories: original
title: "不必复杂，静态博客也可以做短链"
author: 立泉
mention: Jekyll GitHub
date: 2022-05-17 +0800
description: 
cover: 
tags: CS Blog Jekyll GitHub
---

首先，为什么需要短链呢？

```sh
https://apqx.me/post/original/2021/06/10/旅行志03-兰苑狮吼.html
```

这是我博客里一篇文章的完整链接，除去协议和域名，后面的一长串包含了文章类型`original`、写作时间`20210610`和文章标题`旅行志03-兰苑狮吼`，这些信息共同构成了一个指向此`HTML`文档的`URL`，只是稍稍有些长了。

实际上，在从`Markdown`生成静态网页的`Jekyll`中是可以指定输出文章的`URL`结构，确实能做的很短，只需要给每一个`Markdown`文章都手动设置一个自定义[Front Matter](https://jekyllrb.com/docs/front-matter/){: target="_blank" }，然后用它做输出文件名，可以实现类似`https://apqx.me/lxzlysh.html`这样的短链接。

```yml
# Jekyll配置文件 /_config.yml

# 生成页面的URL结构
permalink: /post/:categories/:year/:month/:day/:title:output_ext
# 可以很短，比如 https://apqx.me/lxzlysh.html
permalink: /:custom_front_matter:output_ext
```

但这样的链接中不包含任何文章相关的信息，只有一串手动指定的字符，会不会碰撞是一个问题，另一个问题是`Jekyll`设置的`permalink`其实是文章页面的输出目录。我的长链接是把文章输出到了`/post/original/2021/06/10/`目录下，按指定的结构分类存储，而上面那种短链呢，显然所有的文章都被输出到了根目录，堆成一团。。如果硬要做「短」结构的话，也可以是`/p/o/21/6/10/`，但毕竟不如长链清晰，而且这样好像也不是通常意义上的「短链」了。

这回答了为什么我的博客链接会这么长，再回到一开始的问题，为什么需要短链呢？

`URL`，`Universal Resource Locator`，统一资源定位符，是一个能在茫茫互联网中准确指向一个唯一资源的字符串，当把一篇文章的`URL`分享出去，任何人都可以通过这个`URL`访问到文章所在的网页，就是这么神奇。而我遇到了几个不太`神奇`的问题。

# 问题

> 中文

我的博客`URL`是包含中文的，而中文字符却在标准`URL`字符集之外，实际上包含中文的`URL`需要先通过`URL Encoder`转换为合法字符，然后才能执行所谓`跳转`。另一方面，中文`URL`在分享传播的时候是不需要转码的，可以直接发在微博、朋友圈之类的帖子里，然后点击的话再转码、跳转。

问题是，很多平台在解析`URL`时会以中文作为`URL`结束的标志，它们解析出的可以跳转的只是URL的前一部分，比如微博，如果点击

2. 重定向








https://zhuanlan.zhihu.com/p/102626209

为什么需要短链

* 部分网站不识别中文，不能点击跳转
* 用URLEncode分享的链接太长，超过限制
* 某些时候可能会调整URL结构，用锻炼可以重新映射到新的URL上

Jekyll的URL构成

实现短链的方式

Jekyll的重定向插件

url映射表

生成短链的算法

* 自增，10+26+26进制
* 哈希

需要数据库吗？